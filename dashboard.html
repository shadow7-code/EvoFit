<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EvoFit</title>
  <script>
    (function() {
      try {
        const state = JSON.parse(localStorage.getItem('evoFitApp') || '{}');
        if (state.theme === 'light') {
          document.documentElement.setAttribute('data-theme', 'light');
        }
      } catch (error) {
        localStorage.removeItem('evoFitApp');
      }
    })();
    (function() {
      document.documentElement.dataset.auth = 'pending';
      const isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
      if (!isLoggedIn) {
        const target = window.location.pathname.split('/').pop() || 'dashboard.html';
        window.location.replace(`login.html?redirect=${encodeURIComponent(target)}`);
      } else {
        document.documentElement.dataset.auth = 'granted';
      }
    })();
  </script>
  <style>
    html[data-auth="pending"] body {
      visibility: hidden;
    }
  </style>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="dashboard.css">
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="logo">EvoFit</a>
      <button class="mobile-menu-btn" id="mobileMenuBtn">‚ò∞</button>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html#home">Home</a></li>
        <li id="dashboardLink" style="display: none;"><a href="dashboard.html">Workout</a></li>
        <li><a href="diet.html">Diet</a></li>
        <li><a href="support.html">About</a></li>
        <li><a href="support.html#contact">Contact</a></li>
        <li><a href="login.html" id="loginLink">Login</a></li>
        <li><button class="theme-toggle" id="themeToggle">‚òÄÔ∏è</button></li>
        <li class="profile-container" id="profileContainer" style="display: none;">
          <div class="profile-dropdown">
            <button class="profile-btn" id="profileBtn">üë§</button>
            <div class="profile-menu" id="profileMenu">
              <div class="profile-header">
                <span class="profile-username" id="profileUsername">User</span>
              </div>
              <hr class="profile-divider">
              <a href="profile.html" class="profile-link">View Profile</a>
              <button class="profile-logout" onclick="logoutUser()">Logout</button>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <main class="dashboard-shell">
  <div class="container">
    
    <!-- Header -->
    <div class="header">
      <h1>EvoFit Workout</h1>
      <p>Your Personal Fitness Journey Starts Here</p>
    </div>
    

    <!-- Dashboard Section -->
    <div class="dashboard" id="dashboard">
      <!-- User Details Card -->
      <div class="card">
        <h3>
          <span class="card-icon">üë§</span>
          Personal Profile
        </h3>
        <div class="stat-grid">
          <div class="stat-item">
            <span class="stat-label">Weight</span>
            <span class="stat-value" id="userWeight">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Height</span>
            <span class="stat-value" id="userHeight">--</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Fitness Level</span>
            <span class="stat-value" id="userLevel">--</span>
          </div>
        </div>
        <div id="bmiIndicator" class="bmi-indicator">
          BMI: <span id="bmiValue">--</span>
        </div>
      </div>

      <!-- Stats Card -->
      <div class="card">
        <h3>
          <span class="card-icon">üìä</span>
          Workout Statistics
        </h3>
        <div class="stat-grid">
          <div class="stat-item">
            <span class="stat-label">Total Time</span>
            <span class="stat-value" id="totalTime">0 min</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Calories Burned</span>
            <span class="stat-value" id="totalCalories">0 kcal</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Workouts Completed</span>
            <span class="stat-value" id="workoutCount">0</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Current Streak</span>
            <span class="stat-value" id="currentStreak">0 days</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Workout Control -->
    <div class="workout-controls" id="workoutControls">
      <div class="level-switcher">
        <div class="level-header">
          <h3>Adjust Workout Intensity</h3>
          <span class="current-level" id="currentLevelLabel">--</span>
        </div>
        <div class="level-options" id="levelOptions">
          <button type="button" class="level-btn" data-level="Beginner">Beginner</button>
          <button type="button" class="level-btn" data-level="Intermediate">Intermediate</button>
          <button type="button" class="level-btn" data-level="Advanced">Advanced</button>
        </div>
        <p class="level-hint">Switch levels anytime to instantly adjust your rep targets.</p>
      </div>
      <button class="btn btn-start" id="startWorkoutBtn">
        üöÄ Start Today's Workout
      </button>
    </div>

    <!-- Workout Plan Section -->
    <div class="workout-plan" id="workoutPlan">
      <div class="progress-bar">
        <div class="progress-info">
          <span>Progress: <span id="progressText">0/12</span> exercises</span>
          <span id="workoutTimer">00:00</span>
        </div>
        <div class="progress-track">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
      </div>

      <div class="exercises-grid" id="exercisesGrid">
        <!-- Exercise cards will be inserted here dynamically -->
      </div>
    </div>

    <div class="card monthly-progress" id="monthlyProgress">
      <h3>
        <span class="card-icon">üìÖ</span>
        30-Day Progress
      </h3>
      <div class="monthly-grid">
        <div class="monthly-item">
          <p class="monthly-label">Workouts</p>
          <p class="monthly-value" id="monthlyWorkouts">0</p>
        </div>
        <div class="monthly-item">
          <p class="monthly-label">Minutes</p>
          <p class="monthly-value" id="monthlyMinutes">0</p>
        </div>
        <div class="monthly-item">
          <p class="monthly-label">Calories</p>
          <p class="monthly-value" id="monthlyCalories">0</p>
        </div>
        <div class="monthly-item">
          <p class="monthly-label">Consistency</p>
          <p class="monthly-value" id="monthlyConsistency">0%</p>
        </div>
      </div>
      <div class="monthly-progress-bar">
        <div class="monthly-progress-fill" id="monthlyProgressFill"></div>
      </div>
      <div class="recent-activity">
        <p class="monthly-label">Recent Sessions</p>
        <ul id="recentActivity"></ul>
      </div>
    </div>
  </div>

  <!-- User Input Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-content">
        <h2>Welcome to FitTracker Pro!</h2>
        <form id="userForm">
          <div class="form-group">
            <label for="weight">Weight (kg)</label>
            <input type="number" id="weight" name="weight" required min="30" max="300" step="0.1">
          </div>
          <div class="form-group">
            <label for="height">Height (cm)</label>
            <input type="number" id="height" name="height" required min="100" max="250">
          </div>
          <div class="form-group">
            <label for="level">Fitness Level</label>
            <select id="level" name="level" required>
              <option value="">Select your level</option>
              <option value="Beginner">Beginner</option>
              <option value="Intermediate">Intermediate</option>
              <option value="Advanced">Advanced</option>
            </select>
          </div>
          <button type="submit" class="btn btn-block">Start Your Journey</button>
          <button class="btn btn-block" onclick="window.history.back()">Go Back</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Workout Completion Message -->
  <div class="completion-message" id="completionMessage">
    <h2>üéâ Workout Complete!</h2>
    <p>Fantastic job! You've crushed today's workout!</p>
    <div class="completion-stats">
      <div class="completion-stat">
        <div class="completion-stat-value" id="completionTime">--</div>
        <div class="completion-stat-label">Minutes</div>
      </div>
      <div class="completion-stat">
        <div class="completion-stat-value" id="completionCalories">--</div>
        <div class="completion-stat-label">Calories</div>
      </div>
    </div>
    <button class="btn" onclick="closeCompletionMessage()">Continue</button>
  </div>

  <!-- Reset Button -->
  <button class="btn btn-reset" id="resetBtn">Reset</button>

  <footer class="footer">
    <div class="footer-content">
      <p class="motivational-text">Stay consistent, stay motivated, achieve greatness.</p>
      <div class="footer-links">
        <a href="index.html">Home</a>
      </div>
    </div>
  </footer>
  </main>

  <script src="app-storage.js"></script>
  <script src="script.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>